/*
Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ - Ð¿Ð¾ÑˆÑƒÐº ÐºÑ€Ð°Ñ—Ð½
Ð¡Ñ‚Ð²Ð¾Ñ€Ð¸ Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´ Ñ‡Ð°ÑÑ‚Ð¸Ð½Ñƒ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¸ Ð¿Ð¾ÑˆÑƒÐºÑƒ Ð´Ð°Ð½Ð¸Ñ… Ð¿Ñ€Ð¾ ÐºÑ€Ð°Ñ—Ð½Ñƒ Ð·Ð° Ñ—Ñ— Ñ‡Ð°ÑÑ‚ÐºÐ¾Ð²Ð¾ÑŽ Ð°Ð±Ð¾ Ð¿Ð¾Ð²Ð½Ð¾ÑŽ Ð½Ð°Ð·Ð²Ð¾ÑŽ. ÐŸÐ¾Ð´Ð¸Ð²Ð¸ÑÑ Ð´ÐµÐ¼Ð¾-Ð²Ñ–Ð´ÐµÐ¾ Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¸.
HTTP-Ð·Ð°Ð¿Ð¸Ñ‚
Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹ Ð¿ÑƒÐ±Ð»Ñ–Ñ‡Ð½Ð¸Ð¹ API Rest Countries v2, Ð° ÑÐ°Ð¼Ðµ Ñ€ÐµÑÑƒÑ€Ñ name, ÑÐºÐ¸Ð¹ Ð¿Ð¾Ð²ÐµÑ€Ñ‚Ð°Ñ” Ð¼Ð°ÑÐ¸Ð² Ð¾Ð±'Ñ”ÐºÑ‚Ñ–Ð² ÐºÑ€Ð°Ñ—Ð½, Ñ‰Ð¾ Ð·Ð°Ð´Ð¾Ð²Ð¾Ð»ÑŒÐ½Ð¸Ð»Ð¸ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ñ–Ð¹ Ð¿Ð¾ÑˆÑƒÐºÑƒ. Ð”Ð¾Ð´Ð°Ð¹ Ð¼Ñ–Ð½Ñ–Ð¼Ð°Ð»ÑŒÐ½Ðµ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð½Ñ ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ–Ð² Ñ–Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÑƒ.

ÐÐ°Ð¿Ð¸ÑˆÐ¸ Ñ„ÑƒÐ½ÐºÑ†Ñ–ÑŽ fetchCountries(name), ÑÐºÐ° Ñ€Ð¾Ð±Ð¸Ñ‚ÑŒ HTTP-Ð·Ð°Ð¿Ð¸Ñ‚ Ð½Ð° Ñ€ÐµÑÑƒÑ€Ñ name Ñ– Ð¿Ð¾Ð²ÐµÑ€Ñ‚Ð°Ñ” Ð¿Ñ€Ð¾Ð¼Ñ–Ñ Ð· Ð¼Ð°ÑÐ¸Ð²Ð¾Ð¼ ÐºÑ€Ð°Ñ—Ð½ - Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð¼ Ð·Ð°Ð¿Ð¸Ñ‚Ñƒ. Ð’Ð¸Ð½ÐµÑÐ¸ Ñ—Ñ— Ð² Ð¾ÐºÑ€ÐµÐ¼Ð¸Ð¹ Ñ„Ð°Ð¹Ð» fetchCountries.js Ñ– Ð·Ñ€Ð¾Ð±Ð¸ Ñ–Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ð¹ ÐµÐºÑÐ¿Ð¾Ñ€Ñ‚.

Ð¤Ñ–Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ñ–Ñ Ð¿Ð¾Ð»Ñ–Ð²
Ð£ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ñ– Ð²Ñ–Ð´ Ð±ÐµÐºÐµÐ½Ð´Ñƒ Ð¿Ð¾Ð²ÐµÑ€Ñ‚Ð°ÑŽÑ‚ÑŒÑÑ Ð¾Ð±'Ñ”ÐºÑ‚Ð¸, Ð²ÐµÐ»Ð¸ÐºÐ° Ñ‡Ð°ÑÑ‚Ð¸Ð½Ð° Ð²Ð»Ð°ÑÑ‚Ð¸Ð²Ð¾ÑÑ‚ÐµÐ¹ ÑÐºÐ¸Ñ…, Ñ‚Ð¾Ð±Ñ– Ð½Ðµ Ð·Ð½Ð°Ð´Ð¾Ð±Ð¸Ñ‚ÑŒÑÑ. Ð©Ð¾Ð± ÑÐºÐ¾Ñ€Ð¾Ñ‚Ð¸Ñ‚Ð¸ Ð¾Ð±ÑÑÐ³ Ð¿ÐµÑ€ÐµÐ´Ð°Ð½Ð¸Ñ… Ð´Ð°Ð½Ð¸Ñ…, Ð´Ð¾Ð´Ð°Ð¹ Ñ€ÑÐ´Ð¾Ðº Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ–Ð² Ð·Ð°Ð¿Ð¸Ñ‚Ñƒ - Ñ‚Ð°ÐºÐ¸Ð¼ Ñ‡Ð¸Ð½Ð¾Ð¼ Ñ†ÐµÐ¹ Ð±ÐµÐºÐµÐ½Ð´ Ñ€ÐµÐ°Ð»Ñ–Ð·ÑƒÑ” Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ñ–ÑŽ Ð¿Ð¾Ð»Ñ–Ð². ÐžÐ·Ð½Ð°Ð¹Ð¾Ð¼ÑÑ Ð· Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ñ–Ñ”ÑŽ ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸ÑÑƒ Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ñ–Ð².

Ð¢Ð¾Ð±Ñ– Ð¿Ð¾Ñ‚Ñ€Ñ–Ð±Ð½Ñ– Ñ‚Ñ–Ð»ÑŒÐºÐ¸ Ð½Ð°ÑÑ‚ÑƒÐ¿Ð½Ñ– Ð²Ð»Ð°ÑÑ‚Ð¸Ð²Ð¾ÑÑ‚Ñ–:

name.official - Ð¿Ð¾Ð²Ð½Ð° Ð½Ð°Ð·Ð²Ð° ÐºÑ€Ð°Ñ—Ð½Ð¸
capital - ÑÑ‚Ð¾Ð»Ð¸Ñ†Ñ
population - Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ñ
flags.svg - Ð¿Ð¾ÑÐ¸Ð»Ð°Ð½Ð½Ñ Ð½Ð° Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð½Ñ Ð¿Ñ€Ð°Ð¿Ð¾Ñ€Ð°
languages - Ð¼Ð°ÑÐ¸Ð² Ð¼Ð¾Ð²
ÐŸÐ¾Ð»Ðµ Ð¿Ð¾ÑˆÑƒÐºÑƒ
ÐÐ°Ð·Ð²Ñƒ ÐºÑ€Ð°Ñ—Ð½Ð¸ Ð´Ð»Ñ Ð¿Ð¾ÑˆÑƒÐºÑƒ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð²Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ñƒ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ðµ Ð¿Ð¾Ð»Ðµ input#search-box. HTTP-Ð·Ð°Ð¿Ð¸Ñ‚Ð¸ Ð²Ð¸ÐºÐ¾Ð½ÑƒÑŽÑ‚ÑŒÑÑ Ð¿Ñ€Ð¸ Ð²Ð²ÐµÐ´ÐµÐ½Ð½Ñ– Ð½Ð°Ð·Ð²Ð¸ ÐºÑ€Ð°Ñ—Ð½Ð¸, Ñ‚Ð¾Ð±Ñ‚Ð¾ Ð½Ð° Ð¿Ð¾Ð´Ñ–Ñ— input. ÐÐ»Ðµ Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ Ð·Ð°Ð¿Ð¸Ñ‚ Ð· ÐºÐ¾Ð¶Ð½Ð¸Ð¼ Ð½Ð°Ñ‚Ð¸ÑÐºÐ°Ð½Ð½ÑÐ¼ ÐºÐ»Ð°Ð²Ñ–ÑˆÑ– Ð½Ðµ Ð¼Ð¾Ð¶Ð½Ð°, Ð¾ÑÐºÑ–Ð»ÑŒÐºÐ¸ Ð¾Ð´Ð½Ð¾Ñ‡Ð°ÑÐ½Ð¾ Ð±ÑƒÐ´Ðµ Ð±Ð°Ð³Ð°Ñ‚Ð¾ Ð·Ð°Ð¿Ð¸Ñ‚Ñ–Ð² Ñ– Ð²Ð¾Ð½Ð¸ Ð±ÑƒÐ´ÑƒÑ‚ÑŒ Ð²Ð¸ÐºÐ¾Ð½ÑƒÐ²Ð°Ñ‚Ð¸ÑÑ Ð² Ð½ÐµÐ¿ÐµÑ€ÐµÐ´Ð±Ð°Ñ‡ÑƒÐ²Ð°Ð½Ð¾Ð¼Ñƒ Ð¿Ð¾Ñ€ÑÐ´ÐºÑƒ.

ÐÐµÐ¾Ð±Ñ…Ñ–Ð´Ð½Ð¾ Ð·Ð°ÑÑ‚Ð¾ÑÑƒÐ²Ð°Ñ‚Ð¸ Ð¿Ñ€Ð¸Ð¹Ð¾Ð¼ Debounce Ð½Ð° Ð¾Ð±Ñ€Ð¾Ð±Ð½Ð¸ÐºÑƒ Ð¿Ð¾Ð´Ñ–Ñ— Ñ– Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ HTTP-Ð·Ð°Ð¿Ð¸Ñ‚ Ñ‡ÐµÑ€ÐµÐ· 300Ð¼Ñ Ð¿Ñ–ÑÐ»Ñ Ñ‚Ð¾Ð³Ð¾, ÑÐº ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð¿ÐµÑ€ÐµÑÑ‚Ð°Ð² Ð²Ð²Ð¾Ð´Ð¸Ñ‚Ð¸ Ñ‚ÐµÐºÑÑ‚. Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹ Ð¿Ð°ÐºÐµÑ‚ lodash.debounce.

Ð¯ÐºÑ‰Ð¾ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð¿Ð¾Ð²Ð½Ñ–ÑÑ‚ÑŽ Ð¾Ñ‡Ð¸Ñ‰Ð°Ñ” Ð¿Ð¾Ð»Ðµ Ð¿Ð¾ÑˆÑƒÐºÑƒ, Ñ‚Ð¾ HTTP-Ð·Ð°Ð¿Ð¸Ñ‚ Ð½Ðµ Ð²Ð¸ÐºÐ¾Ð½ÑƒÑ”Ñ‚ÑŒÑÑ, Ð° Ñ€Ð¾Ð·Ð¼Ñ–Ñ‚ÐºÐ° ÑÐ¿Ð¸ÑÐºÑƒ ÐºÑ€Ð°Ñ—Ð½ Ð°Ð±Ð¾ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ— Ð¿Ñ€Ð¾ ÐºÑ€Ð°Ñ—Ð½Ñƒ Ð·Ð½Ð¸ÐºÐ°Ñ”.

Ð’Ð¸ÐºÐ¾Ð½Ð°Ð¹ ÑÐ°Ð½Ñ–Ñ‚Ð¸Ð·Ð°Ñ†Ñ–ÑŽ Ð²Ð²ÐµÐ´ÐµÐ½Ð¾Ð³Ð¾ Ñ€ÑÐ´ÐºÐ° Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ trim(), Ñ†Ðµ Ð²Ð¸Ñ€Ñ–ÑˆÐ¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ, ÐºÐ¾Ð»Ð¸ Ð² Ð¿Ð¾Ð»Ñ– Ð²Ð²ÐµÐ´ÐµÐ½Ð½Ñ Ñ‚Ñ–Ð»ÑŒÐºÐ¸ Ð¿Ñ€Ð¾Ð±Ñ–Ð»Ð¸, Ð°Ð±Ð¾ Ð²Ð¾Ð½Ð¸ Ñ” Ð½Ð° Ð¿Ð¾Ñ‡Ð°Ñ‚ÐºÑƒ Ñ– Ð² ÐºÑ–Ð½Ñ†Ñ– Ñ€ÑÐ´ÐºÐ°.

Ð†Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ
Ð¯ÐºÑ‰Ð¾ Ñƒ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ñ– Ð±ÐµÐºÐµÐ½Ð´ Ð¿Ð¾Ð²ÐµÑ€Ð½ÑƒÐ² Ð±Ñ–Ð»ÑŒÑˆÐµ Ð½Ñ–Ð¶ 10 ÐºÑ€Ð°Ñ—Ð½, Ð² Ñ–Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÑ– Ð·'ÑÐ²Ð»ÑÑ”Ñ‚ÑŒÑÑ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ Ð¿Ñ€Ð¾ Ñ‚Ðµ, Ñ‰Ð¾ Ð½Ð°Ð·Ð²Ð° Ð¿Ð¾Ð²Ð¸Ð½Ð½Ð° Ð±ÑƒÑ‚Ð¸ ÑÐ¿ÐµÑ†Ð¸Ñ„Ñ–Ñ‡Ð½Ñ–ÑˆÐ¾ÑŽ. Ð”Ð»Ñ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½ÑŒ Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹ Ð±Ñ–Ð±Ð»Ñ–Ð¾Ñ‚ÐµÐºÑƒ notiflix Ñ– Ð²Ð¸Ð²Ð¾Ð´ÑŒ Ñ‚Ð°ÐºÐ¸Ð¹ Ñ€ÑÐ´Ð¾Ðº "Too many matches found. Please enter a more specific name.".

Too many matches alert

Ð¯ÐºÑ‰Ð¾ Ð±ÐµÐºÐµÐ½Ð´ Ð¿Ð¾Ð²ÐµÑ€Ð½ÑƒÐ² Ð²Ñ–Ð´ 2-Ñ… Ð´Ð¾ 10-Ð¸ ÐºÑ€Ð°Ñ—Ð½, Ð¿Ñ–Ð´ Ñ‚ÐµÑÑ‚Ð¾Ð²Ð¸Ð¼ Ð¿Ð¾Ð»ÐµÐ¼ Ð²Ñ–Ð´Ð¾Ð±Ñ€Ð°Ð¶Ð°Ñ”Ñ‚ÑŒÑÑ ÑÐ¿Ð¸ÑÐ¾Ðº Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¸Ñ… ÐºÑ€Ð°Ñ—Ð½. ÐšÐ¾Ð¶ÐµÐ½ ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚ ÑÐ¿Ð¸ÑÐºÑƒ ÑÐºÐ»Ð°Ð´Ð°Ñ”Ñ‚ÑŒÑÑ Ð· Ð¿Ñ€Ð°Ð¿Ð¾Ñ€Ð° Ñ‚Ð° Ð½Ð°Ð·Ð²Ð¸ ÐºÑ€Ð°Ñ—Ð½Ð¸.

Country list UI

Ð¯ÐºÑ‰Ð¾ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð·Ð°Ð¿Ð¸Ñ‚Ñƒ - Ñ†Ðµ Ð¼Ð°ÑÐ¸Ð² Ð· Ð¾Ð´Ð½Ñ–Ñ”ÑŽ ÐºÑ€Ð°Ñ—Ð½Ð¾ÑŽ, Ð² Ñ–Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÑ– Ð²Ñ–Ð´Ð¾Ð±Ñ€Ð°Ð¶Ð°Ñ”Ñ‚ÑŒÑÑ Ñ€Ð¾Ð·Ð¼Ñ–Ñ‚ÐºÐ° ÐºÐ°Ñ€Ñ‚ÐºÐ¸ Ð· Ð´Ð°Ð½Ð¸Ð¼Ð¸ Ð¿Ñ€Ð¾ ÐºÑ€Ð°Ñ—Ð½Ñƒ: Ð¿Ñ€Ð°Ð¿Ð¾Ñ€, Ð½Ð°Ð·Ð²Ð°, ÑÑ‚Ð¾Ð»Ð¸Ñ†Ñ, Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ñ Ñ– Ð¼Ð¾Ð²Ð¸.

Country info UI

Ð£Ð’ÐÐ“Ð
Ð”Ð¾ÑÑ‚Ð°Ñ‚Ð½ÑŒÐ¾, Ñ‰Ð¾Ð± Ð·Ð°ÑÑ‚Ð¾ÑÑƒÐ½Ð¾Ðº Ð¿Ñ€Ð°Ñ†ÑŽÐ²Ð°Ð² Ð´Ð»Ñ Ð±Ñ–Ð»ÑŒÑˆÐ¾ÑÑ‚Ñ– ÐºÑ€Ð°Ñ—Ð½. Ð”ÐµÑÐºÑ– ÐºÑ€Ð°Ñ—Ð½Ð¸, ÑÐº-Ð¾Ñ‚ Sudan, Ð¼Ð¾Ð¶ÑƒÑ‚ÑŒ ÑÑ‚Ð²Ð¾Ñ€ÑŽÐ²Ð°Ñ‚Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð¸, Ð¾ÑÐºÑ–Ð»ÑŒÐºÐ¸ Ð½Ð°Ð·Ð²Ð° ÐºÑ€Ð°Ñ—Ð½Ð¸ Ñ” Ñ‡Ð°ÑÑ‚Ð¸Ð½Ð¾ÑŽ Ð½Ð°Ð·Ð²Ð¸ Ñ–Ð½ÑˆÐ¾Ñ— ÐºÑ€Ð°Ñ—Ð½Ð¸ - South Sudan. ÐÐµ Ð¿Ð¾Ñ‚Ñ€Ñ–Ð±Ð½Ð¾ Ñ‚ÑƒÑ€Ð±ÑƒÐ²Ð°Ñ‚Ð¸ÑÑ Ð¿Ñ€Ð¾ Ñ†Ñ– Ð²Ð¸Ð½ÑÑ‚ÐºÐ¸.

ÐžÐ±Ñ€Ð¾Ð±ÐºÐ° Ð¿Ð¾Ð¼Ð¸Ð»ÐºÐ¸
Ð¯ÐºÑ‰Ð¾ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð²Ð²Ñ–Ð² Ð½Ð°Ð·Ð²Ñƒ ÐºÑ€Ð°Ñ—Ð½Ð¸, ÑÐºÐ¾Ñ— Ð½Ðµ Ñ–ÑÐ½ÑƒÑ”, Ð±ÐµÐºÐµÐ½Ð´ Ð¿Ð¾Ð²ÐµÑ€Ð½Ðµ Ð½Ðµ Ð¿Ð¾Ñ€Ð¾Ð¶Ð½Ñ–Ð¹ Ð¼Ð°ÑÐ¸Ð², Ð° Ð¿Ð¾Ð¼Ð¸Ð»ÐºÑƒ Ð·Ñ– ÑÑ‚Ð°Ñ‚ÑƒÑ ÐºÐ¾Ð´Ð¾Ð¼ 404 - Ð½Ðµ Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾. Ð¯ÐºÑ‰Ð¾ Ñ†Ðµ Ð½Ðµ Ð¾Ð±Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸, Ñ‚Ð¾ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð½Ñ–ÐºÐ¾Ð»Ð¸ Ð½Ðµ Ð´Ñ–Ð·Ð½Ð°Ñ”Ñ‚ÑŒÑÑ Ð¿Ñ€Ð¾ Ñ‚Ðµ, Ñ‰Ð¾ Ð¿Ð¾ÑˆÑƒÐº Ð½Ðµ Ð´Ð°Ð² Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ–Ð². Ð”Ð¾Ð´Ð°Ð¹ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ "Oops, there is no country with that name" Ñƒ Ñ€Ð°Ð·Ñ– Ð¿Ð¾Ð¼Ð¸Ð»ÐºÐ¸, Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑŽÑ‡Ð¸ Ð±Ñ–Ð±Ð»Ñ–Ð¾Ñ‚ÐµÐºÑƒ notiflix.

Error alert

Ð£Ð’ÐÐ“Ð
ÐÐµ Ð·Ð°Ð±ÑƒÐ²Ð°Ð¹ Ð¿Ñ€Ð¾ Ñ‚Ðµ, Ñ‰Ð¾ fetch Ð½Ðµ Ð²Ð²Ð°Ð¶Ð°Ñ” 404 Ð¿Ð¾Ð¼Ð¸Ð»ÐºÐ¾ÑŽ, Ñ‚Ð¾Ð¼Ñƒ Ð½ÐµÐ¾Ð±Ñ…Ñ–Ð´Ð½Ð¾ ÑÐ²Ð½Ð¾ Ð²Ñ–Ð´Ñ…Ð¸Ð»Ð¸Ñ‚Ð¸ Ð¿Ñ€Ð¾Ð¼Ñ–Ñ, Ñ‰Ð¾Ð± Ð¼Ð¾Ð¶Ð½Ð° Ð±ÑƒÐ»Ð¾ Ð·Ð»Ð¾Ð²Ð¸Ñ‚Ð¸ Ñ– Ð¾Ð±Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ Ð¿Ð¾Ð¼Ð¸Ð»ÐºÑƒ.
*/

import './css/styles.css';
import Notiflix from 'notiflix';
import debounce from 'lodash.debounce';
import { fetchCountries } from './fetchCountries'; // Ð†Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ð¹ Ñ–Ð¼Ð¿Ð¾Ñ€Ñ‚

const DEBOUNCE_DELAY = 300; // Ð·Ð°Ñ‚Ñ€Ð¸Ð¼ÐºÐ° Ð´Ð»Ñ Ð´ÐµÐ±Ð¾ÑƒÐ½Ñ

// const searchEl = document.querySelector('#search-box');
// const countryInfo = document.querySelector('.country-info');
// const countryList = document.querySelector('.country-list');

const refs = {
  searchEl : document.querySelector('#search-box'),
 countryInfo : document.querySelector('.country-info'),
 countryList : document.querySelector('.country-list'),
};


const clearMarkup = ref => (ref.innerHTML = '');

const inputHandler = e => {
  const textInput = e.target.value.trim();

  if (!textInput) {
    clearMarkup(refs.countryList);
    clearMarkup(refs.countryInfo);
    return;
  }

  fetchCountries(textInput)
    .then(data => {
      console.log(data);
      if (data.length > 10) {
        Notify.info(
          'Too many matches found. Please enter a more specific name'
        );
        return;
      }
      renderMarkup(data);
    })
    .catch(err => {
      clearMarkup(refs.countryList);
      clearMarkup(refs.countryInfo);
      Notify.failure('Oops...ðŸ§Ÿâ€â™‚ï¸, there is no country with that name');
    });
};

const renderMarkup = data => {
  if (data.length === 1) {
    clearMarkup(refs.countryList);
    const markupInfo = createInfoMarkup(data);
    refs.countryInfo.innerHTML = markupInfo;
  } else {
    clearMarkup(refs.countryInfo);
    const markupList = createListMarkup(data);
    refs.countryList.innerHTML = markupList;
  }
};

const createListMarkup = data => {
  return data
    .map(
      ({ name, flags }) =>
        `<li><img src="${flags.png}" alt="${name.official}" width="60" height="40">${name.official}</li>`
    )
    .join('');
};

const createInfoMarkup = data => {
  return data.map(
    ({ name, capital, population, flags, languages }) =>
      `<img src="${flags.png}" alt="${name.official}" width="200" height="100">
      <h1>${name.official}</h1>
      <p>Capital: ${capital}</p>
      <p>Population: ${population}</p>
      <p>Languages: ${Object.values(languages)}</p>`
  );
};

refs.searchEl.addEventListener('input', debounce(inputHandler, DEBOUNCE_DELAY));
